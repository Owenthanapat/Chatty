version : '2'
services:
    #mongo db
    mongo:
        image : mongo:4.2.6
        ports: 
            - 27017:27017
    #front
    front:
        build: ./chatty_frontend
        volumes: 
            - ./chatty_frontend:/usr/src/app
        ports: 
            - 3000:3000
        tty : true 
    #back1
    back1:
        build: ./chatty-nest
        tty: true
        depends_on :
            - mongo
        volumes: 
            - ./chatty-nest:/usr/src/app
        ports: 
            - 3001:4000
    #back2
    back2:
        build: ./chatty-nest
        tty: true
        depends_on :
            - mongo
        volumes: 
            - ./chatty-nest:/usr/src/app
        ports: 
            - 3002:4000
    #loadbalancer
    load-balancer:
        build: ./load_balancer
        links: 
            - back1 
            - back2
        ports: 
            - 8080:8080